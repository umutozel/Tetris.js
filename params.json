{"name":"Tetris.js","tagline":"A simple tetris.","body":"<canvas id=\"myCanvas\" width=\"300\" height=\"600\" style=\"border:1px solid #000000;margin-left: auto;margin-right: auto;margin-top: auto;margin-bottom: auto;display: block;\" />\r\n<script>\r\n    var ctx = document.getElementById(\"myCanvas\").getContext(\"2d\");\r\n    var s = [[0x00F0, 0x4444], [0x6600], [0x4640, 0x4E00, 0x4C40, 0x0E40], [0x0E80, 0x6220, 0x2E00, 0x88C0], [0x0E20, 0x44C0, 0x8E00, 0xC880], [0x06C0, 0x8C40], [0x0C60, 0x4C80]],\r\n        a = [0xFFFF, 0xE007, 0xE007, 0xE007, 0xE007, 0xE007, 0xE007, 0xE007, 0xE007, 0xE007, 0xE007, 0xE007, 0xE007, 0xE007, 0xE007, 0xE007, 0xE007, 0xE007, 0xE007, 0xE007, 0xE007, 0xFFFF, 0xFFFF];\r\n    function to10(bin) { return parseInt(bin.split('').join(''), 2); }\r\n    function pad(str, ne, nt, c) { return Array(nt - str.length - ne + 1).join(c || '0') + str + (ne > 0 ? Array(nt - ne - str.length + 1).join(c || '0') : ''); }\r\n    function move(as, i, x, y) {\r\n        var is = [prep(0), prep(1), prep(2), prep(3)];\r\n        function prep(j) { return [as[y + j], to10(pad(pad(i.toString(2), 0, 16).substring(j * 4, (j + 1) * 4), x + 3, 16))]; }\r\n        return !(is[0][0] & is[0][1]) && (as[y] = (is[0][0] | is[0][1])) && !(is[1][0] & is[1][1]) && (as[y + 1] = (is[1][0] | is[1][1]))\r\n            && !(is[2][0] & is[2][1]) && (as[y + 2] = (is[2][0] | is[2][1])) && !(is[3][0] & is[3][1]) && (as[y + 3] = (is[3][0] | is[3][1])) && as;\r\n    }\r\n    var x = 3, y = 0, i, si, as = a, at = a, l = 0, ii, p = 1, t = 15;\r\n    function update(key) {\r\n        i = i || s[Math.floor(si = (Math.random() * s.length))].slice(0), l = ++l % t, key = key && (key.key || key.keyIdentifier);\r\n        var xx = x, yy = y, ai = i.slice(0);\r\n        if (!l || key == \"Down\") yy++;\r\n        else if (key == \"Left\") xx--;\r\n        else if (key == \"Right\") xx++;\r\n        else if (key == \"Up\") ai.push(ai.shift());\r\n        if (!(at = move(a.slice(0), ai[0], xx, yy))) {\r\n            if (!l || key == \"Down\") {\r\n                if (y < 1) {\r\n                    clearInterval(ii);\r\n                    window.removeEventListener(\"keydown\", update);\r\n                    alert('game over, score: ' + p);\r\n                }\r\n                for (var k = 1, e = 0; k < 21; k++)\r\n                    if (as[k] == 65535) {\r\n                        as.splice(k, ++e / e);\r\n                        as.splice(1, 0, 0xE007);\r\n                    }\r\n                i = y = 0, x = 3, a = as, p += Math.pow(2, e);\r\n            }\r\n        } else {\r\n            y = yy, x = xx, i = ai;\r\n            draw(as = at);\r\n        }\r\n    }\r\n    function draw(as) {\r\n        ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height);\r\n        for (var i = 1, w = ctx.canvas.width / 10, h = ctx.canvas.height / 20; i < 21; i++)\r\n            for (var j = 0, r = as[i].toString(2).substring(3, 13) ; j < 10; j++) {\r\n                ctx.fillStyle = r[j] == \"0\" ? \"rgb(255,255,255)\" : \"rgb(0, 0, 0)\";\r\n                ctx.fillRect(w * j, h * (i - 1), w, h);\r\n            }\r\n    }\r\n    window.addEventListener(\"keydown\", update);\r\n    ii = setInterval(update, 30);\r\n</script>","google":"UA-53854654-1","note":"Don't delete this file! It's used internally to help with page regeneration."}